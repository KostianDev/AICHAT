/*
 * AICHAT - Advanced Image Color Harmony Analysis and Transformation
 * Build configuration
 */

plugins {
    id 'application'
    id 'org.openjfx.javafxplugin' version '0.1.0'
    id 'info.solidsoft.pitest' version '1.19.0-rc.2'
    id 'me.champeau.jmh' version '0.7.3'
}

repositories {
    mavenCentral()
}

// Java 25 toolchain
java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(25)
    }
}

// JavaFX configuration
javafx {
    version = "25"
    modules = ['javafx.controls', 'javafx.fxml', 'javafx.swing']
}

dependencies {
    // Guava utilities
    implementation libs.guava
    
    // Unit Testing - JUnit 5
    testImplementation libs.junit.jupiter
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
    
    // Property-Based Testing - jqwik
    testImplementation 'net.jqwik:jqwik:1.9.3'
    
    // Image comparison for visual regression testing
    testImplementation 'com.github.romankh3:image-comparison:4.4.0'
    
    // JMH for benchmarks
    jmh 'org.openjdk.jmh:jmh-core:1.37'
    jmh 'org.openjdk.jmh:jmh-generator-annprocess:1.37'
}

application {
    mainClass = 'aichat.App'
}

tasks.named('test') {
    useJUnitPlatform()
    
    // Include jqwik property-based tests
    include '**/*Test.class'
    include '**/*Tests.class'
    include '**/*Properties.class'
}

// Pitest mutation testing configuration
pitest {
    targetClasses = ['aichat.core.*', 'aichat.algorithm.*', 'aichat.color.*']
    targetTests = ['aichat.*']
    pitestVersion = '1.17.3'
    junit5PluginVersion = '1.2.1'
    threads = 4
    outputFormats = ['HTML', 'XML']
    mutationThreshold = 85
    coverageThreshold = 80
}

// JMH benchmarks configuration
jmh {
    iterations = 5
    warmupIterations = 3
    fork = 1
    resultFormat = 'JSON'
}
